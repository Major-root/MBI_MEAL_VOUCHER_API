**Meal Voucher API - Endpoint Plan**

---

### ğŸ“… Authentication

**POST /auth/register/staff**  â†’ Register new staff (admin only)

**POST /auth/register/vendor**  â†’ Register new vendor (admin only)

**POST /auth/login**  â†’ Login endpoint (shared by staff and vendors)

**GET /auth/me**  â†’ Get logged-in user profile
**POST /auth/bulk-register -> bulk register users from an excel file or csv

---

### ğŸ‘¥ Staff

**GET /staff**  â†’ Get all staff (admin only)

**GET /staff/\:id**  â†’ Get staff by ID

**PATCH /staff/\:id**  â†’ Update staff info

**DELETE /staff/\:id**  â†’ Deactivate staff

---

### ğŸ© Vendors

**GET /vendors**  â†’ List all vendors

**GET /vendors/\:id**  â†’ Get vendor profile

**PATCH /vendors/\:id**  â†’ Update vendor info

**DELETE /vendors/\:id**  â†’ Remove vendor

---

### ğŸ² Vouchers

**GET /vouchers**  â†’ Get vouchers (staff only, filter by week, status)

**POST /vouchers/buy**  â†’ Purchase available voucher(s)

**POST /vouchers/gift**  â†’ Gift a voucher (bought or unbought)

**GET /vouchers/history**  â†’ Get full voucher history

**GET /vouchers/available**  â†’ Get available (unbought) vouchers

---

### ğŸ† Orders

**POST /orders**  â†’ Create order using vouchers (returns code like MB-XYZ)

**GET /orders/\:id**  â†’ Get order details

**GET /orders/history**  â†’ View past orders by user

---

### ğŸ”¹ Redeem

**POST /redeem**  â†’ Vendor redeems order (code input)

**GET /redeem/logs**  â†’ Vendor views redeemed history

---

### ğŸ Visitor Vouchers

**POST /visitor-vouchers**  â†’ HR creates special voucher for a visitor

**GET /visitor-vouchers/\:code**  â†’ Vendor verifies visitor voucher

**POST /visitor-vouchers/redeem**  â†’ Vendor redeems visitor voucher

---

### ğŸŒŸ Admin Tools

**POST /admin/vouchers/allocate**  â†’ Run cron manually to allocate vouchers

**POST /admin/vouchers/deallocate**  â†’ Run cron to remove unused vouchers

**POST /admin/holidays**  â†’ Set public holidays

**GET /admin/reports/weekly**  â†’ Weekly report summary

**GET /admin/reports/vendor/\:id**  â†’ Vendor-wise report

---

### âš™ï¸ Settings / Meta

**GET /ticket-types**  â†’ Get available ticket types

**GET /roles**  â†’ View roles

**GET /week-cycles**  â†’ View all weeks

**GET /transactions**  â†’ View all transactions (admin only)


 Wallet & Transactions

GET    /wallet                        â†’ View wallet balance

POST   /wallet/fund                  â†’ Initiate wallet funding (Paystack)

POST   /paystack/webhook             â†’ Handle Paystack payment callback

GET    /transactions                 â†’ Staff: List wallet transactions

GET    /payments                     â†’ Admin: List all external payments


 Gifting & Visitor Vouchers

POST   /vouchers/gift                â†’ Gift owned or allocated voucher to another staff

POST   /visitor/voucher              â†’ Admin issues special voucher to a visitor

GET    /visitor/vouchers             â†’ Admin view all visitor vouchers issued

ğŸ“… Weekly Cron Jobs (Internal Only)

CRON   allocate-weekly-vouchers      â†’ Every Monday 7AM

CRON   deallocate-unused-vouchers    â†’ Every Sunday 11:59PM

CRON   generate-weekly-report        â†’ Optional weekly summary per staff/vendor

ğŸ“† Holidays

POST   /holidays                     â†’ Admin adds a public holiday

GET    /holidays                     â†’ View upcoming holidays

âš™ï¸ Admin Tools

GET    /admin/dashboard              â†’ Metrics overview

GET    /admin/activity-log           â†’ System audit 

### âš ï¸ Notes:

* Auth uses shared login `/auth/login`, but after login, user type is determined from DB.
* Use middleware to protect routes based on roles (e.g., HR, vendor, staff).
* Use enums for ticket type, voucher status, and transaction types.
* `MB-XXXXXX` codes are generated when creating an order or issuing visitor vouchers.
